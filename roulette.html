<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>検閲システム - 投稿規制中</title>
    <style>
        body { background-color: #efefef; color: #ff0000; font-family: "MS PGothic", sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; text-align: center; }
        .warning-box { border: 2px solid #ff0000; background: #fff; padding: 30px; max-width: 600px; box-shadow: 10px 10px 0 #ccc; }
        #roulette-display { font-size: 2.5rem; font-weight: bold; padding: 20px; background: #000; color: #0f0; margin: 20px 0; border: 4px double #0f0; min-width: 300px; }
        button { padding: 15px 30px; background: #ff0000; color: #fff; border: none; cursor: pointer; font-weight: bold; font-size: 1.2rem; }
        #roulette-section { display: none; }
    </style>
</head>
<body>

<div class="warning-box" id="warning">
    <h1>⚠️ 検閲対象として識別 ⚠️</h1>
    <p>あなたの発言は検閲AIにより「極めて興味深い」と判断されました。</p>
    <p>思考回路をスキャン中...</p>
    <div id="prog-text">0%</div>
</div>

<div class="warning-box" id="roulette-section">
    <h1>運命の再審査</h1>
    <div id="roulette-display">READY?</div>
    <button id="spin-btn" onclick="spin()">再審査を開始（クリックで音が出ます）</button>
</div>

<script>
    // 音を鳴らすためのAudioContext
    let audioCtx;
    function playBeep(freq, type, duration, vol = 0.1) {
        if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(vol, audioCtx.currentTime);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
        osc.stop(audioCtx.currentTime + duration);
    }

    // 1. ロード演出（ここはクリック前なので無音）
    let prog = 0;
    const interval = setInterval(() => {
        prog += 5;
        document.getElementById('prog-text').innerText = prog + "%";
        if(prog >= 100) {
            clearInterval(interval);
            document.getElementById('warning').style.display = 'none';
            document.getElementById('roulette-section').style.display = 'block';
        }
    }, 50);

    // 2. ルーレット
    const results = ["即刻BAN", "一生ROM", "家宅捜索", "猫化", "★奇跡★", "再起動", "データ消去"];
    function spin() {
        const btn = document.getElementById('spin-btn');
        btn.disabled = true;
        btn.style.display = "none";

        let count = 0;
        const spinTimer = setInterval(() => {
            const res = results[count % results.length];
            document.getElementById('roulette-display').innerText = res;
            
            // 回転音（ピッ、ピッ、ピッ）
            playBeep(440 + (count % 5) * 100, 'sine', 0.1);
            
            count++;
            if(count > 30) {
                clearInterval(spinTimer);
                finish();
            }
        }, 100);
    }

    function finish() {
        // 当選
        document.getElementById('roulette-display').innerText = "★奇跡の当選★";
        document.getElementById('roulette-display').style.backgroundColor = "#ff0";
        document.getElementById('roulette-display').style.color = "#f00";

        // ファンファーレ音（ドミソド！）
        [523, 659, 783, 1046].forEach((f, i) => {
            setTimeout(() => playBeep(f, 'square', 0.6, 0.2), i * 150);
        });

        setTimeout(() => {
            alert("検閲を通過しました。top.html へ戻ります。");
            window.location.href = "top.html";
        }, 1500);
    }
</script>
</body>
</html>
