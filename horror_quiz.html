<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>MILLIONAIRE PROTOCOL | THE COMPLETE INSANE EDITION</title>
    <style>
        body {
            background: radial-gradient(circle, #000022 0%, #000000 100%);
            color: #fff; font-family: "Hiragino Mincho ProN", serif;
            display: flex; align-items: center; justify-content: center;
            height: 100vh; margin: 0; overflow: hidden;
            transition: background 0.1s;
        }
        #game-container { display: flex; width: 95%; max-width: 1100px; gap: 30px; align-items: flex-end; }
        #main-area { flex: 3; display: flex; flex-direction: column; align-items: center; }
        #menu-screen, #game-ui, #success-screen { display: none; width: 100%; text-align: center; }
        
        #narrator-box { color: #800; font-size: 16px; min-height: 24px; margin-bottom: 10px; font-style: italic; letter-spacing: 2px; }
        
        #question-box {
            width: 100%; padding: 40px; margin-bottom: 30px; font-size: 22px; line-height: 1.6;
            background: linear-gradient(180deg, #000011 0%, #000033 50%, #000011 100%);
            border: 1px solid #444; border-radius: 60px / 120px; box-sizing: border-box;
        }
        .answer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; }
        .answer-btn {
            background: #000; border: 1px solid #333; border-radius: 40px; padding: 15px 25px;
            color: #aaa; font-size: 18px; text-align: left; cursor: pointer; transition: 0.3s;
        }
        .answer-btn:hover:not(.hidden-opt) { border-color: #800; color: #fff; background: #100; box-shadow: 0 0 15px #800; }
        .label { color: #800; font-weight: bold; margin-right: 15px; }
        .hidden-opt { visibility: hidden; pointer-events: none; }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        #sidebar { flex: 1; background: rgba(0,0,0,0.8); border: 1px solid #222; border-radius: 10px; padding: 20px; display: flex; flex-direction: column; }
        .money-step { display: flex; justify-content: space-between; padding: 2px 10px; font-family: monospace; color: #500; font-size: 14px; }
        .current-step { color: #f00; text-shadow: 0 0 5px #f00; font-weight: bold; }
        .passed-step { color: #222; }

        .lifeline-btn { width: 60px; height: 35px; border-radius: 50%; border: 1px solid #444; background: #000; color: #666; cursor: pointer; margin-bottom: 10px; font-size: 18px; }
        .lifeline-btn.used { text-decoration: line-through; opacity: 0.2; }

        /* èµ¤ã„æ‰‹ã®æ¼”å‡º */
        .hand-trigger { font-size: 120px; cursor: pointer; position: relative; display: inline-block; transition: transform 0.2s; }
        .hand-trigger:hover { transform: scale(1.1); }
        .return-text { font-size: 20px; color: #f00; font-weight: bold; letter-spacing: 8px; margin-top: -10px; opacity: 0.6; }

        /* å¸°é‚„ã®ç‚¹æ»… */
        @keyframes red-flash { 0% { background: #000; } 50% { background: #f00; } 100% { background: #000; } }
        .return-ritual { animation: red-flash 0.1s infinite !important; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="main-area">
        <div id="menu-screen" style="display: block;">
            <h1 style="color: #800; letter-spacing: 5px;">MILLIONAIRE PROTOCOL</h1>
            <p style="font-size: 12px; color: #444;">â€»è­¦å‘Šï¼šçœŸå®Ÿã‚’çŸ¥ã‚‹è¦šæ‚Ÿã®ãªã„è€…ã¯ç«‹ã¡å»ã‚Œ</p>
            <button class="menu-btn answer-btn" style="width:100%; margin-bottom:10px;" onclick="startGame('EASY')">EASY [æœ‰åãƒ›ãƒ©ãƒ¼ã®è¨˜æ†¶]</button>
            <button class="menu-btn answer-btn" style="width:100%; margin-bottom:10px;" onclick="startGame('NORMAL')">NORMAL [å¥‡å¦™ãªç¾å®Ÿã®ç‹­é–“]</button>
            <button class="menu-btn answer-btn" style="width:100%;" onclick="startGame('HARD')">HARD [æœªè§£æ±ºãƒ»ç¦å¿Œã®çœŸå®Ÿ]</button>
        </div>

        <div id="game-ui">
            <div id="narrator-box"></div>
            <div id="question-box"></div>
            <div class="answer-grid">
                <button class="answer-btn" id="btn-A" onclick="checkAnswer('A')"><span class="label">A:</span> <span id="opt-A"></span></button>
                <button class="answer-btn" id="btn-B" onclick="checkAnswer('B')"><span class="label">B:</span> <span id="opt-B"></span></button>
                <button class="answer-btn" id="btn-C" onclick="checkAnswer('C')"><span class="label">C:</span> <span id="opt-C"></span></button>
                <button class="answer-btn" id="btn-D" onclick="checkAnswer('D')"><span class="label">D:</span> <span id="opt-D"></span></button>
            </div>
            <button id="walk-away-btn" onclick="walkAway()" style="margin-top: 30px; background: #100; color: #600; border: 1px solid #300; padding: 10px 25px; border-radius: 20px; cursor: pointer; font-size: 12px; font-family: serif; transition: 0.3s;">
                ã“ã“ã§è¾ã‚ã‚‹ï¼ˆå®Ÿç¸¾ã‚’ç¢ºå®šã—ã¦å¸°é‚„ã™ã‚‹ï¼‰
            </button>
        </div>

        <div id="success-screen">
            <h1 id="success-title" style="color: #800; font-size: 40px; letter-spacing: 10px;">MISSION COMPLETE</h1>
            <div class="hand-trigger" id="finalBtn">
                <span id="hand-icon" style="color: #a00; filter: drop-shadow(0 0 15px #f00);">ğŸ–</span>
                <div class="return-text">å¸° é‚„</div>
            </div>
            <p id="reward-display" style="font-size: 14px; color: #666; margin-top: 20px;"></p>
        </div>
    </div>

    <div id="sidebar">
        <div class="lifeline-area">
            <button id="fifty" class="lifeline-btn" onclick="useFifty()">50</button>
            <button id="phone" class="lifeline-btn" onclick="usePhone()">ğŸ“</button>
        </div>
        <div id="money-ladder"></div>
    </div>
</div>

<script>
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playFreq(f, d, v=0.05) {
    const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
    o.frequency.value = f; g.gain.value = v; o.connect(g); g.connect(audioCtx.destination);
    o.start(); o.stop(audioCtx.currentTime + d);
}

const moneyList = ["10,000", "20,000", "30,000", "50,000", "100,000", "250,000", "500,000", "1,000,000", "2,500,000", "10,000,000"];
const narrations = ["ã‚ˆã†ã“ãã€‚çŸ¥ã‚‰ãªã„æ–¹ãŒå¹¸ã›ã ã£ãŸçœŸå®Ÿã®é ˜åŸŸã§ã™ã€‚", "ã¾ã ã€å¼•ãè¿”ã›ã¾ã™ã€‚ä»Šã®ã†ã¡ã§ã™ã‚ˆã€‚", "è€³ã‚’æ¾„ã¾ã›ã¦ãã ã•ã„ã€‚ä½•ã‹èã“ãˆã¾ã›ã‚“ã‹ï¼Ÿ", "ã‚ãªãŸã®å¾Œã‚ã®æˆ¸ç· ã¾ã‚Šã€ç¢ºèªã—ã¾ã—ãŸã‹ï¼Ÿ", "åŠåˆ†ã¾ã§æ¥ã¾ã—ãŸã€‚å¿ƒè‡“ã®éŸ³ã€é€Ÿããªã£ã¦ã„ã¾ã™ã­ã€‚", "é€ƒã’é“ã¯ã€ã‚‚ã†ã‚ã‚Šã¾ã›ã‚“ã€‚", "çœŸå®Ÿã«è¿‘ã¥ãã»ã©ã€ä¸–ç•Œã¯è‰²ã‚’å¤±ã„ã¾ã™ã€‚", "â€¦ä»Šã®éŸ³ã€æ°—ä»˜ãã¾ã—ãŸã‹ï¼Ÿ", "æ¬¡ã‚’æ­£è§£ã™ã‚Œã°æœ€å¾Œã€‚â€¦ã‚ãªãŸãŒæœ€å¾Œã®ä¸€äººã«ãªã‚‹ç•ªã§ã™ã€‚", "æœ€å¾Œã®ä¸€å•ã€‚æ±ºã—ã¦ã€å¾Œã‚ã‚’æŒ¯ã‚Šè¿”ã‚‰ãªã„ã§ãã ã•ã„ã€‚"];
const hardComments = ["â€¦9äººã®éºä½“ã¯ã€å†…å´ã‹ã‚‰åˆ‡ã‚Šè£‚ã‹ã‚ŒãŸãƒ†ãƒ³ãƒˆã®å…ˆã«ã‚ã‚Šã¾ã—ãŸã€‚", "â€¦ç¿¼ã‚’åºƒã’ãŸãã‚Œã¯ã€ä¸å‰ãªäºˆå…†ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚", "â€¦è»ãŒå›åã—ãŸã€ç ´ç‰‡ã€ã®è¡Œæ–¹ã¯ã€ä»Šã‚‚ä¸æ˜ã§ã™ã€‚", "â€¦å½¼ã¯ã©ã“ã¸æ¶ˆãˆãŸã®ã‹ã€‚ç›®æ’ƒè€…ã¯ã‚ãªãŸã ã‘ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚", "â€¦æ¹–åº•ã«ã¯ã€ã¾ã ç§‘å­¦ã®å±Šã‹ãªã„æ·±æ·µãŒã‚ã‚Šã¾ã™ã€‚", "â€¦çŠ¯äººã¯ä»Šã€ã‚ãªãŸã®éš£ã§ã“ã®ç”»é¢ã‚’è¦—ã„ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚", "â€¦åŠé€æ˜ã®ãã‚Œã¯ã€å…‰ã‚’å±ˆæŠ˜ã•ã›ã¦ç²ç‰©ã‚’å¾…ã¡ã¾ã™ã€‚", "â€¦çŠ¯äººã®æŒ‡ç´‹ã€é´ã®è·¡ã€‚ãã‚Œã ã‘ã‚ã£ã¦ã‚‚ã€èª°ã«ã‚‚è¾¿ã‚Šç€ã‘ãªã„ã€‚", "â€¦æ¯ã‚Œæœã¦ãŸå®¶ç•œã®èº«ä½“ã«ã¯ã€ä¸€æ»´ã®è¡€ã‚‚æ®‹ã£ã¦ã„ãªã‹ã£ãŸã€‚", "â€¦è¦–ç•Œã®ç«¯ã«æ˜ ã‚‹ã€é»’ã„å½±ã€ã€‚ãã‚ŒãŒå½¼ã‚‰ã§ã™ã€‚"];

const quizData = {
    EASY: [
        { q: "ã‚¢ãƒ‹ãƒ¡ã€ã²ãã‚‰ã—ã®ãªãé ƒã«ã€ã§ã€ç‰©èªã®èˆå°ã¨ãªã‚‹æ‘ã®åå‰ã¯ï¼Ÿ", a: "é››è¦‹æ²¢æ‘", b: "é¬¼éš æ‘", c: "ç¶¿æµæ‘", d: "æ˜­å’Œæ‘", ans: "A" },
        { q: "æ˜ ç”»ã€ãƒªãƒ³ã‚°ã€ã§ã€å‘ªã„ã®ãƒ“ãƒ‡ã‚ªã‚’è¦‹ãŸäººãŒæ­»ã¬ã¾ã§ã®æ—¥æ•°ã¯ï¼Ÿ", a: "3æ—¥", b: "5æ—¥", c: "7æ—¥", d: "10æ—¥", ans: "C" },
        { q: "ã‚¢ãƒ‹ãƒ¡ã€Anotherã€ã§ã€ã‚¯ãƒ©ã‚¹å†…ã«å­˜åœ¨ã—ã¦ã¯ã„ã‘ãªã„ã¨ã•ã‚Œã‚‹äººç‰©ã¯ï¼Ÿ", a: "è»¢æ ¡ç”Ÿ", b: "æ‹…ä»»æ•™å¸«", c: "æ­»è€…", d: "ç”Ÿå¾’ä¼šé•·", ans: "C" },
        { q: "æ˜ ç”»ã€å‘ªæ€¨ã€ã§ç¾ã‚Œã‚‹éœŠã®ç‰¹å¾´çš„ãªéŸ³ã¯ï¼Ÿ", a: "ç¬‘ã„å£°", b: "çŒ«ã®é³´ãå£°", c: "ã†ã‚ãå£°", d: "å–‰ã‚’é³´ã‚‰ã™ã‚ˆã†ãªéŸ³", ans: "D" },
        { q: "ãƒ‰ãƒ©ãƒã€ä¸–ã«ã‚‚å¥‡å¦™ãªç‰©èªã€ã§ã€ç‰©èªã®æœ€å¾Œã«ã‚ˆãè¡¨ç¤ºã•ã‚Œã‚‹è¨€è‘‰ã¯ï¼Ÿ", a: "END", b: "FIN", c: "ã¤ã¥ã", d: "å¥‡å¦™ãªä¸–ç•Œã¯çµ‚ã‚ã‚‰ãªã„", ans: "D" },
        { q: "æ˜ ç”»ã€ITï¼ã‚¤ãƒƒãƒˆã€ã§å­ã©ã‚‚ãŸã¡ã‚’ææ€–ã«é™¥ã‚Œã‚‹å­˜åœ¨ã®å§¿ã¯ï¼Ÿ", a: "é­”å¥³", b: "ãƒ”ã‚¨ãƒ­", c: "äººå½¢", d: "é“åŒ–å¸«ã®ä»®é¢", ans: "B" },
        { q: "ã‚¢ãƒ‹ãƒ¡ã€åœ°ç„å°‘å¥³ã€ã§ã€ä¾é ¼ã‚’ã™ã‚‹ã¨ç›¸æ‰‹ãŒé€ã‚‰ã‚Œã‚‹å ´æ‰€ã¯ï¼Ÿ", a: "å†¥ç•Œ", b: "é»„æ³‰", c: "åœ°ç„", d: "å¥ˆè½", ans: "C" },
        { q: "æ˜ ç”»ã€ã‚·ãƒƒã‚¯ã‚¹ãƒ»ã‚»ãƒ³ã‚¹ã€ã§ã€å°‘å¹´ãŒã€Œè¦‹ãˆã‚‹ã€ã¨å‘Šç™½ã™ã‚‹ã‚‚ã®ã¯ï¼Ÿ", a: "æœªæ¥", b: "æ‚ªé­”", c: "æ­»è€…", d: "è¨˜æ†¶", ans: "C" },
        { q: "ã‚¢ãƒ‹ãƒ¡ã€å­¦æ ¡ã®æ€ªè«‡ã€ã«ç™»å ´ã™ã‚‹ã€èªå°¾ã«ã€Œã€œã ã¹ã€ã¨ã¤ã‘ã‚‹ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¯ï¼Ÿ", a: "èŠ±å­ã•ã‚“", b: "å¤©ã®é‚ªé¬¼", c: "ã®ã£ãºã‚‰ã¼ã†", d: "èµ¤ãƒãƒ³ãƒˆ", ans: "B" },
        { q: "æ˜ ç”»ã€ã‚­ãƒ£ãƒªãƒ¼ã€ã§ã€ä¸»äººå…¬ãŒè¶…èƒ½åŠ›ã‚’ä½¿ã„å§‹ã‚ã‚‹ãã£ã‹ã‘ã¨ãªã‚‹åŠ›ã¯ï¼Ÿ", a: "å¿µå‹•åŠ›", b: "äºˆçŸ¥èƒ½åŠ›", c: "å‚¬çœ è¡“", d: "ç¬é–“ç§»å‹•", ans: "A" }
    ],
    NORMAL: [
        { q: "ã€ã‚¨ã‚¯ã‚½ã‚·ã‚¹ãƒˆã€ã®å®Ÿè©±ã§ã€å°‘å¹´ã®ä½“ã«æµ®ã‹ã³ä¸ŠãŒã£ãŸæ–‡å­—ã¯ï¼Ÿ", a: "HELP", b: "HELL", c: "DIE", d: "EVIL", ans: "A" },
        { q: "1930å¹´ä»£ã€ã‚«ãƒŠãƒ€ã§æ‘äººå…¨å“¡ãŒè¡£æœã‚’æ®‹ã—ãŸã¾ã¾æ¶ˆãˆãŸæ¹–ã®åã¯ï¼Ÿ", a: "ã‚¢ãƒ³ã‚¸ã‚¯ãƒ‹æ¹–", b: "ãƒ­ã‚¢ãƒãƒ¼ã‚¯æ¹–", c: "ãƒ¡ã‚¢ãƒªãƒ¼æ¹–", d: "ãƒã‚¤ã‚«ãƒ«æ¹–", ans: "A" },
        { q: "ãƒãƒŸãƒ¥ãƒ¼ãƒ€ãƒ»ãƒˆãƒ©ã‚¤ã‚¢ãƒ³ã‚°ãƒ«ã§æ¶ˆå¤±ã—ãŸçˆ†æ’ƒæ©Ÿã€‚æœ€å¾Œã®é€šä¿¡å†…å®¹ã¯ï¼Ÿ", a: "ä½•ã‚‚è¦‹ãˆãªã„", b: "æµ·ãŒç™½ãå…‰ã£ã¦ã„ã‚‹", c: "ç©ºãŒèµ¤ã„", d: "ç‡ƒæ–™ãŒåˆ‡ã‚ŒãŸ", ans: "B" },
        { q: "ã€ãƒ´ã‚©ã‚¤ãƒ‹ãƒƒãƒæ‰‹ç¨¿ã€ã«æã‹ã‚Œã¦ã„ã‚‹æ¤ç‰©ã®å…±é€šç‚¹ã¯ï¼Ÿ", a: "çŒ›æ¯’ãŒã‚ã‚‹", b: "åœ°çƒä¸Šã«å­˜åœ¨ã—ãªã„", c: "äººãŒæã„ãŸã‚‚ã®ã§ã¯ãªã„", d: "ã™ã¹ã¦æ¯ã‚Œã¦ã„ã‚‹", ans: "B" },
        { q: "ãƒãƒ«ã‚¿ãƒ¼ã‚¬ã‚¤ã‚¹ãƒˆäº‹ä»¶ã§å°‘å¥³ã«æ†‘ä¾ã—ãŸè€äººã®åã¯ï¼Ÿ", a: "ã‚¸ãƒ£ãƒƒã‚¯", b: "ãƒ“ãƒ«", c: "ãƒˆãƒ ", d: "ãƒãƒªãƒ¼", ans: "B" },
        { q: "18ä¸–ç´€ãƒ•ãƒ©ãƒ³ã‚¹ã®ã€ã‚¸ã‚§ãƒ´ã‚©ãƒ¼ãƒ€ãƒ³ã®ç£ã€ã€‚æœ‰åŠ›ãªæ­£ä½“èª¬ã¯ï¼Ÿ", a: "å·¨å¤§ãªç‹¼", b: "ãƒã‚¤ã‚¨ãƒŠ", c: "ãƒ©ã‚¤ã‚ªãƒ³", d: "ã‚¯ãƒ", ans: "A" },
        { q: "ã€ã‚¹ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒãƒ³ã€ãŒé€£ã‚Œå»ã‚‹å ´æ‰€ã¨ã•ã‚Œã‚‹ã®ã¯ï¼Ÿ", a: "ã‚¯ãƒ­ãƒ¼ã‚¼ãƒƒãƒˆ", b: "æ·±ã„æ£®", c: "åœ°ä¸‹é‰„", d: "é¡ã®ä¸­", ans: "B" },
        { q: "ã‚¨ãƒªã‚µãƒ»ãƒ©ãƒ ãŒæœ€å¾Œã«è¦‹ã‚‰ã‚ŒãŸæ™‚ã«ç€ã¦ã„ãŸæœã®è‰²ã¯ï¼Ÿ", a: "ç™½", b: "èµ¤", c: "é»’", d: "é’", ans: "B" },
        { q: "ã€çŠ¬é³´æ‘ã€çœ‹æ¿ã®æ–‡è¨€ã¯ï¼Ÿ", a: "åœ°ç„ã¸ã‚ˆã†ã“ã", b: "æ—¥æœ¬æ†²æ³•é€šã˜ãš", c: "ç«‹ã¡å»ã‚Œ", d: "å‡ºå£ãªã—", ans: "B" },
        { q: "ã€è™šèˆŸä¼èª¬ã€ã®å¥³æ€§ãŒæŠ±ãˆã¦ã„ãŸã®ã¯ï¼Ÿ", a: "æ–", b: "è¬ã®ç®±", c: "èµ¤ã‚“åŠ", d: "é«‘é«", ans: "B" }
    ],
    HARD: [
        { q: "1959å¹´ã€ã‚½é€£ç™»å±±éšŠ9äººã®ä¸å¯è§£ãªæ­»ã®äº‹ä»¶åã¯ï¼Ÿ", a: "ã‚¦ãƒ©ãƒ«æƒ¨æ®ºäº‹ä»¶", b: "ãƒ‡ã‚£ã‚¢ãƒˆãƒ­ãƒ•å³ äº‹ä»¶", c: "ã‚·ãƒ™ãƒªã‚¢äº‹ä»¶", d: "é›ªå±±äº‹ä»¶", ans: "B" },
        { q: "60å¹´ä»£ã«å¤šæ•°ç›®æ’ƒã•ã‚ŒãŸã€ç¿¼ã‚’æŒã¤äººå‹å­˜åœ¨ã¯ï¼Ÿ", a: "ã‚¹ã‚«ã‚¤ãƒãƒ³", b: "ãƒŠã‚¤ãƒˆãƒ•ãƒ©ã‚¤ãƒ¤ãƒ¼", c: "ãƒ¢ã‚¹ãƒãƒ³", d: "ã‚¨ãƒ³ã‚¸ã‚§ãƒ«", ans: "C" },
        { q: "1947å¹´ã€ç±³ãƒ‹ãƒ¥ãƒ¼ãƒ¡ã‚­ã‚·ã‚³å·ã®UFOå¢œè½äº‹ä»¶ã¯ï¼Ÿ", a: "ã‚¨ãƒªã‚¢51", b: "ãƒ­ã‚ºã‚¦ã‚§ãƒ«äº‹ä»¶", c: "ãƒšãƒ³ã‚¿ã‚´ãƒ³", d: "ãƒ›ãƒ¯ã‚¤ãƒˆã‚µãƒ³ã‚º", ans: "B" },
        { q: "1974å¹´ã€æ—¥æœ¬ã®ç”·æ€§çªç„¶æ¶ˆå¤±äº‹ä»¶ã¯ï¼Ÿ", a: "ä¸–ç”°è°·äº‹ä»¶", b: "ä¸‰å„„å††äº‹ä»¶", c: "æ´¥å±±äº‹ä»¶", d: "èˆ¹æ©‹é§…å‰å¤±è¸ªäº‹ä»¶", ans: "D" },
        { q: "ã‚¹ã‚³ãƒƒãƒˆãƒ©ãƒ³ãƒ‰ã®æ¹–ã«ç”Ÿæ¯ã™ã‚‹ã¨è¨€ã‚ã‚Œã‚‹UMAã¯ï¼Ÿ", a: "ãƒãƒ¥ãƒ‘ã‚«ãƒ–ãƒ©", b: "ãƒ¢ã‚±ãƒ¼ãƒ¬", c: "ãƒãƒƒã‚·ãƒ¼", d: "ã‚ªã‚´ãƒã‚´", ans: "C" },
        { q: "æ­£ä½“ä¸æ˜ã®é€£ç¶šæ®ºäººé¬¼ã€ŒZã€ã¯ä½•ã¨å‘¼ã°ã‚Œã‚‹ï¼Ÿ", a: "ã‚¸ãƒ£ãƒƒã‚¯", b: "Zodiacäº‹ä»¶", c: "ãƒ–ãƒ©ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰", d: "ã‚­ãƒ©ãƒ¼Z", ans: "B" },
        { q: "ãƒ•ãƒ­ãƒªãƒ€å·ã§ç›®æ’ƒã•ã‚ŒãŸåŠé€æ˜ã®æœªç¢ºèªç”Ÿç‰©ã¯ï¼Ÿ", a: "ã‚·ãƒ£ãƒ‰ã‚¦", b: "ãƒ•ãƒ©ãƒƒãƒˆã‚¦ãƒƒã‚º", c: "ã‚¹ã‚«ãƒ³ã‚¯ã‚¨ã‚¤ãƒ—", d: "ãƒ•ãƒ­ãƒªãƒ€ãƒ»ã‚¸ã‚§ãƒªãƒ¼", ans: "D" },
        { q: "ç¾å ´ã«å¤§é‡ã®è¨¼æ‹ ã‚’æ®‹ã—ãŸæ—¥æœ¬ã®æœªè§£æ±ºäº‹ä»¶ã¯ï¼Ÿ", a: "ã‚°ãƒªã‚³", b: "ä¸‰å„„å††", c: "ä¸–ç”°è°·ä¸€å®¶æ®ºå®³äº‹ä»¶", d: "å…«ç‹å­ã‚¹ãƒ¼ãƒ‘ãƒ¼", ans: "C" },
        { q: "å®¶ç•œã®è¡€ã‚’æŠœãã¨ã•ã‚Œã‚‹å—ç±³ã®æœªç¢ºèªç”Ÿç‰©ã¯ï¼Ÿ", a: "ãƒ¢ã‚¹ãƒãƒ³", b: "ãƒãƒ¥ãƒ‘ã‚«ãƒ–ãƒ©", c: "ãƒ“ãƒƒã‚°ãƒ•ãƒƒãƒˆ", d: "ãƒ¨ãƒ­ãƒ¼ãƒŠ", ans: "B" },
        { q: "ä¸–ç•Œä¸­ã§ç›®æ’ƒã•ã‚Œã‚‹ã€ç‰¹å®šä¸èƒ½ã®ã€Œé»’ã„å½±ã€ã®ç¾è±¡ã¯ï¼Ÿ", a: "ãƒ©ã‚¤ãƒˆãƒ‹ãƒ³ã‚°", b: "ãƒ‘ãƒ©ãƒªã‚·ã‚¹", c: "ã‚·ãƒ£ãƒ‰ã‚¦ãƒ‘ãƒ¼ã‚½ãƒ³", d: "é›†å›£å¹»è¦š", ans: "C" }
    ]
};

let currentLevel = ''; let currentStep = 0; let fiftyUsed = false; let phoneUsed = false;

function startGame(lv) {
    if (audioCtx.state === 'suspended') audioCtx.resume();
    currentLevel = lv; currentStep = 0; fiftyUsed = false; phoneUsed = false;
    document.getElementById('menu-screen').style.display = 'none';
    document.getElementById('game-ui').style.display = 'block';
    document.getElementById('fifty').classList.remove('used');
    document.getElementById('phone').classList.remove('used');
    initLadder(); updateView();
}

function initLadder() {
    const ladder = document.getElementById('money-ladder'); ladder.innerHTML = '';
    for (let i = moneyList.length - 1; i >= 0; i--) {
        const div = document.createElement('div'); div.id = `step-${i}`; div.className = 'money-step';
        div.innerHTML = `<span>${i + 1}</span> <span>Â¥${moneyList[i]}</span>`;
        ladder.appendChild(div);
    }
}

function updateView() {
    if (currentStep >= 10) { showResult(); return; }
    for (let i = 0; i < 10; i++) {
        const el = document.getElementById(`step-${i}`); el.className = 'money-step';
        if (i === currentStep) el.classList.add('current-step'); else if (i < currentStep) el.classList.add('passed-step');
    }
    const data = quizData[currentLevel][currentStep];
    document.getElementById('narrator-box').innerText = narrations[currentStep];
    document.getElementById('question-box').innerText = data.q;
    ['A','B','C','D'].forEach(opt => {
        const b = document.getElementById('btn-'+opt); b.classList.remove('hidden-opt');
        document.getElementById('opt-'+opt).innerText = data[opt.toLowerCase()];
    });
}

function checkAnswer(pick) {
    playFreq(200, 0.2);
    if (confirm("ãƒ•ã‚¡ã‚¤ãƒŠãƒ«ã‚¢ãƒ³ã‚µãƒ¼â€¦ï¼Ÿ")) {
        if (pick === quizData[currentLevel][currentStep].ans) {
            playFreq(600, 0.4);
            alert((currentLevel === 'HARD') ? hardComments[currentStep] : "æ­£è§£ã§ã™â€¦");
            currentStep++; updateView();
        } else {
            playFreq(80, 1.5); document.body.style.background = "#500";
            alert("ä¸æ­£è§£ã€‚ã‚ãªãŸã¯é—‡ã«é£²ã¾ã‚Œã¾ã—ãŸã€‚"); location.reload();
        }
    }
}

function walkAway() {
    if (currentStep === 0) { alert("ã¾ã å®Ÿç¸¾ãŒã‚ã‚Šã¾ã›ã‚“ã€‚"); return; }
    const prize = moneyList[currentStep - 1];
    if (confirm(`ç¾åœ¨ã®å®Ÿç¸¾ Â¥${prize} ã‚’æŒã£ã¦ã€ç¾ä¸–ã¸å¸°é‚„ã—ã¾ã™ã‹â€¦ï¼Ÿ`)) {
        showResult(prize);
    }
}

function useFifty() {
    if (fiftyUsed) return; fiftyUsed = true; document.getElementById('fifty').classList.add('used');
    const correct = quizData[currentLevel][currentStep].ans;
    const options = ['A','B','C','D'].filter(opt => opt !== correct);
    for (let i=0; i<2; i++) {
        const target = options.splice(Math.floor(Math.random()*options.length), 1)[0];
        document.getElementById(`btn-${target}`).classList.add('hidden-opt');
    }
}

function usePhone() {
    if (phoneUsed) return; phoneUsed = true; document.getElementById('phone').classList.add('used');
    const msg = (currentStep < 7) ? `ã€Œâ€¦ç­”ãˆã¯ ${quizData[currentLevel][currentStep].ans} ã ã€‚æ—©ãã—ã¦ãã‚Œâ€¦ã€` : "ã€Œâ€¦â€¦ã†ã€å¾Œã‚â€¦â€¦ã«â€¦â€¦ã€";
    alert(`ã€é€šä¿¡ç¢ºç«‹ã€‘\n\n${msg}`);
}

function showResult(amount = null) {
    document.getElementById('game-ui').style.display = 'none';
    document.getElementById('success-screen').style.display = 'block';
    const finalAmount = amount || moneyList[9];
    const msg = (currentLevel === 'HARD' && currentStep === 10) 
        ? "ã‚ãªãŸã¯å…¨ã¦ã‚’çŸ¥ã£ã¦ã—ã¾ã£ãŸã€‚ã‚‚ã†ã€çŸ¥ã‚‰ãªã„é ƒã®è‡ªåˆ†ã«ã¯æˆ»ã‚Œã¾ã›ã‚“ã€‚" 
        : `ç²å¾—å®Ÿç¸¾: Â¥${finalAmount} ï¼ ã‚ãªãŸã¯ç„¡äº‹ã«å¸°é‚„ã—ã¾ã—ãŸã€‚`;
    document.getElementById('reward-display').innerText = msg;
}

document.getElementById('finalBtn').onclick = function() {
    document.body.classList.add('return-ritual');
    playFreq(80, 2.0, 0.4); playFreq(1000, 0.1, 0.2);
    setTimeout(() => { alert("â€¦â€¦å¸°é‚„ã‚’æ‰¿èªã—ã¾ã—ãŸã€‚äºŒåº¦ã¨ã“ã¡ã‚‰ã¸æ¥ãªã„ã‚ˆã†ã«ã€‚"); window.location.href = "index.html"; }, 2500);
};
</script>
</body>
</html>